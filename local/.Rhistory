ggplot(data = train, aes(x="", y = dist)) + geom_boxplot()
ggplot(data = train, aes(y = dist)) + geom_bar()
ggplot(data = train, aes(y = dist, x=num)) + geom_bar()
train.book.dist <- group_by(train, ISBN) %>% summarise(
num = length(User.ID),
dist = mean(dist)
)
ggplot(data = train.book.dist, aes(y = dist, x=num)) + geom_bar()
train.book.dist <- group_by(train, ISBN) %>% summarise(
num = length(User.ID),
dist = mean(dist)
)
ggplot(data = train.book.dist, aes(y = dist, x=as.factor(num))) + geom_bar()
train.book.dist <- group_by(train, ISBN) %>% summarise(
num = length(User.ID),
dist = mean(dist)
)
ggplot(data = train.book.dist, aes(x=num) + geom_bar()
train.book.dist <- group_by(train, ISBN) %>% summarise(
num = length(User.ID),
dist = mean(dist)
)
ggplot(data = train.book.dist, aes(x=num)) + geom_bar()
train.book.dist <- group_by(train, ISBN) %>% summarise(
num = length(User.ID),
dist = mean(dist)
)
ggplot(data = train.book.dist[which(train.book.dist$num<50), ], aes(x=num)) + geom_bar()
train.book.dist <- group_by(train, ISBN) %>% summarise(
num = length(User.ID),
dist = mean(dist)
)
ggplot(data = train.book.dist[which(train.book.dist$num<30), ], aes(x=num)) + geom_bar()
train.book.dist <- group_by(train, ISBN) %>% summarise(
num = length(User.ID),
dist = mean(dist)
)
ggplot(data = train.book.dist[which(train.book.dist$num<30&train.book.dist$num>3), ], aes(x=num)) + geom_bar()
train.book.dist <- group_by(train, ISBN) %>% summarise(
num = length(User.ID),
dist = mean(dist)
)
ggplot(data = train.book.dist[which(train.book.dist$num<30&train.book.dist$num>2), ], aes(x=num)) + geom_bar()
train.book.dist <- group_by(train, ISBN) %>% summarise(
num = length(User.ID),
dist = mean(dist)
)
ggplot(data = train.book.dist[which(train.book.dist$num<30&train.book.dist$num>1), ], aes(x=num)) + geom_bar()
train.book.dist <- group_by(train, ISBN) %>% summarise(
num = length(User.ID),
dist = mean(dist)
)
ggplot(data = train.book.dist[which(train.book.dist$num<30&train.book.dist$num>3), ], aes(x=num)) + geom_bar()
ggplot(data = train.book.dist, aes(x=num, y=dist))+geom_point()
ggsave("plot/distnum.pdf")
train.book.dist <- group_by(train, ISBN) %>% summarise(
num = length(User.ID),
dist = mean(dist)
)
train.book.dist <- group_by(train.book.dist, num) %>% summarise(
dist = mean(num*dist)
)
ggplot(data = train.book.dist, aes(x=num, y=dist))+geom_point()
ggsave("plot/distnum.pdf")
length(train.book.dist$dist < 0.5)/nrow(train.book.dist)
length(train.book.dist$dist < 0.5)
nrow(train.book.dist)
train.book.dist <- group_by(train, ISBN) %>% summarise(
num = length(User.ID),
dist = mean(dist)
)
ggplot(data = train.book.dist[which(train.book.dist$num<30&train.book.dist$num>3), ], aes(x=num)) + geom_bar()
train.book.dist <- group_by(train, ISBN) %>% summarise(
num = length(User.ID),
dist = mean(dist)
)
train.book.dist <- group_by(train.book.dist, num) %>% summarise(
d = sum(num*dist)/length(dist)
)
ggplot(data = train.book.dist, aes(x=num, y=d))+geom_point()
ggsave("plot/distnum.pdf")
train.book.dist <- group_by(train, ISBN) %>% summarise(
num = length(User.ID),
dist = mean(dist)
)
ggplot(data = train.book.dist[which(train.book.dist$num<30&train.book.dist$num>3), ], aes(x=num)) + geom_bar()
ggplot(data = train.book.dist, aes(x=num, y=d))+geom_point()+xlab("Number of Ratings")+ylab("Distance")
train.book.dist <- group_by(train, ISBN) %>% summarise(
num = length(User.ID),
dist = mean(dist)
)
train.book.dist <- group_by(train.book.dist, num) %>% summarise(
d = mean(dist)
)
ggplot(data = train.book.dist, aes(x=num, y=d))+geom_point()+xlab("Number of Ratings")+ylab("Distance")
ggsave("plot/distnum.pdf")
length(train.book.dist$dist < 0.5)/nrow(train.book.dist)
length(train.book.dist$d < 0.5)/nrow(train.book.dist)
length(train.book.dist$d < 1)/nrow(train.book.dist)
length(train.book.dist$d < 1)
train.book.dist$d
sum(train.book.dist$d < 1)/nrow(train.book.dist)
sum(train.book.dist$d < 1)/nrow(train.book.dist)
ggplot(data = train.book.dist, aes(x="", y=d))+geom_boxplot()
sum(train.book.dist$d < 1)/nrow(train.book.dist)
ggplot(data = train.book.dist, aes(x="", y=d))+geom_boxplot()
ggsave("plot/distboxplot.pdf")
aaa
x=result$V[1, idx]
y=result$V[2, idx]
sqrt(x^2+y^2)
aaa
View(aaa)
ggplot(data = train.book.dist, aes(x=num, y=d))+geom_point()+xlab("Number of Ratings")+ylab("Distance")
ggsave("plot/distnum.pdf")
sum(train.book.dist$d < 1)/nrow(train.book.dist)
ggplot(data = train.book.dist, aes(x="", y=d))+geom_boxplot()
ggsave("plot/distboxplot.pdf")
train.book.dist <- group_by(train, ISBN) %>% summarise(
num = length(User.ID),
dist = mean(dist)
)
ggplot(data = train.book.dist[which(train.book.dist$num<30&train.book.dist$num>3), ], aes(x=num)) + geom_bar()
train.book.dist <- group_by(train, ISBN) %>% summarise(
num = length(User.ID),
dist = mean(dist)
)
ggplot(data = train.book.dist[which(train.book.dist$num<30&train.book.dist$num>3), ], aes(x=num)) + geom_bar()+xlab("Number of Ratings")
ggsave("plot/distnumbar.pdf")
load("result/lpmf/gd-2.Rda")
dist <- NULL
for(i in 1:nrow(train)){
dist[i] <- sqrt(sum(result$U[, train[i, "ISBN"]]^2))
}
train$dist <-dist
train.book.dist <- group_by(train, ISBN) %>% summarise(
num = length(User.ID),
dist = mean(dist)
)
train.book.dist <- group_by(train.book.dist, num) %>% summarise(
d = mean(dist)
)
ggplot(data = train.book.dist, aes(x=num, y=d))+geom_point()+xlab("Number of Ratings")+ylab("Distance")
ggsave("plot/distnumuser.pdf")
train.book.dist <- group_by(train, ISBN) %>% summarise(
num = length(User.ID),
dist = mean(dist)
)
ggplot(data = train.book.dist[which(train.book.dist$num<30&train.book.dist$num>3), ], aes(x=num)) + geom_bar()+xlab("Number of Ratings")
ggsave("plot/distnumbaruser.pdf")
load("result/ws_lpmf/mm-2.Rda")
result.ws <- result
load("result/lpmf/gd-2.Rda")
result.lpmf <- result
sourceCpp("cpp/pred_ws_lpmf.cpp")
sourceCpp("cpp/pred_lpmf.cpp")
sourceCpp("cpp/pred_bookavg.cpp")
load("FU.Rda")
load("FV.Rda")
load("grp_df.Rda")
grp_df[[1]] <- NULL
grp_df[[1]] <- NULL
grp_rst <- lapply(grp_df, function(df){
df$Book.Rating <- (df$Book.Rating-1)/9
lpmf <-  pred_lpmf(df, t(result.lpmf$U), t(result.lpmf$V))
ws <- pred_ws_lpmf(df,t(FU), t(FV), t(result.ws$WU), t(result.ws$WV))
avg <- pred_bookavg(df, book_avg, book_idx1)
return(list(lpmf = lpmf, ws = ws, avg = avg))
})
ggplot(data = NULL, aes(x=mae.lpmf))+geom_bar()
load("result/ws_lpmf/mm-2.Rda")
result.ws <- result
load("result/lpmf/gd-2.Rda")
result.lpmf <- result
sourceCpp("cpp/pred_ws_lpmf.cpp")
sourceCpp("cpp/pred_lpmf.cpp")
sourceCpp("cpp/pred_bookavg.cpp")
load("FU.Rda")
load("FV.Rda")
load("grp_df.Rda")
grp_df[[1]] <- NULL
grp_df[[1]] <- NULL
grp_rst <- lapply(grp_df, function(df){
df$Book.Rating <- (df$Book.Rating-1)/9
lpmf <-  pred_lpmf(df, t(result.lpmf$U), t(result.lpmf$V))
ws <- pred_ws_lpmf(df,t(FU), t(FV), t(result.ws$WU), t(result.ws$WV))
avg <- pred_bookavg(df, book_avg, book_idx1)
return(list(lpmf = lpmf, ws = ws, avg = avg))
})
train <- read.csv("archive/train0.csv")
train$ISBN <- book_idx[train$ISBN]
test <- read.csv("archive/test0.csv")
test$ISBN <- book_idx[test$ISBN]
train$Book.Rating <- (train$Book.Rating - 1)/9
test$Book.Rating <- (test$Book.Rating - 1)/9
train.book.avg <- group_by(train, ISBN) %>% summarise(
avg.rating = mean(Book.Rating)
)
test <- test[which(test$ISBN %in% train.book.avg$ISBN),]
book_avg <- train.book.avg$avg.rating
names(book_avg) <- train.book.avg$ISBN
book_idx1 <- names(book_avg)
load("result/ws_lpmf/mm-2.Rda")
result.ws <- result
load("result/lpmf/gd-2.Rda")
result.lpmf <- result
sourceCpp("cpp/pred_ws_lpmf.cpp")
sourceCpp("cpp/pred_lpmf.cpp")
sourceCpp("cpp/pred_bookavg.cpp")
load("FU.Rda")
load("FV.Rda")
load("grp_df.Rda")
grp_df[[1]] <- NULL
grp_df[[1]] <- NULL
grp_rst <- lapply(grp_df, function(df){
df$Book.Rating <- (df$Book.Rating-1)/9
lpmf <-  pred_lpmf(df, t(result.lpmf$U), t(result.lpmf$V))
ws <- pred_ws_lpmf(df,t(FU), t(FV), t(result.ws$WU), t(result.ws$WV))
avg <- pred_bookavg(df, book_avg, book_idx1)
return(list(lpmf = lpmf, ws = ws, avg = avg))
})
mae.lpmf <- NULL
mae.ws <- NULL
mae.avg <- NULL
rmse.lpmf <- NULL
rmse.ws <- NULL
rmse.avg <- NULL
for(i in 1:9){
aaa <- grp_rst[[i]]
lpmf.aaa <- aaa$lpmf
ws.aaa <- aaa$ws
avg.aaa <- aaa$avg
mae.lpmf[i] <- lpmf.aaa$mae
mae.ws[i] <- ws.aaa$mae
mae.avg[i] <- avg.aaa$mae
rmse.lpmf[i] <- lpmf.aaa$rmse
rmse.ws[i] <- ws.aaa$rmse
rmse.avg[i] <- avg.aaa$rmse
}
load("grp_df.Rda")
grp_num <- sapply(grp_df, function(x){
nrow(x)
})
names(grp_num) <- c("0", "1-3", "4-6", "7-9", "10-13", "14-17", "18-19", "20-23", "24-50", "51-100", ">100")
ggplot(data = data.frame(mae.lpmf = mae.lpmf, usergrp = names(grp_num)), aes(x=mae.lpmf))+geom_bar()+xlab()+ylab("MAE")
ggplot(data = data.frame(mae.lpmf = mae.lpmf, usergrp = names(grp_num)[3:11]), aes(x=mae.lpmf))+geom_bar()+xlab()+ylab("MAE")
ggplot(data = data.frame(mae.lpmf = mae.lpmf, usergrp = names(grp_num)[3:11]), aes(x=mae.lpmf))+geom_bar()+xlab("User Groups")+ylab("MAE")
ggplot(data = data.frame(mae.lpmf = mae.lpmf, usergrp = names(grp_num)[3:11]), aes(x=usergrp))+geom_bar()+xlab("User Groups")+ylab("MAE")
data.frame(mae.lpmf = mae.lpmf, usergrp = names(grp_num)[3:11])
ggplot(data = data.frame(mae.lpmf = mae.lpmf, usergrp = names(grp_num)[3:11]), aes(x=usergrp, y=mae.lpmf))+geom_point()+xlab("User Groups")+ylab("MAE")
ggplot(data = data.frame(mae.lpmf = mae.lpmf, usergrp = 1:9), aes(x=usergrp, y=mae.lpmf))+geom_point()+ylab("MAE")+scale_x_discrete("User Groups", labels = names(grp_num)[3:11])
ggplot(data = data.frame(mae.lpmf = mae.lpmf, usergrp = 1:9), aes(x=usergrp, y=mae.lpmf))+geom_point()+ylab("MAE")+xlab("User Groups", label = names(grp_num)[3:11])
ggplot(data = data.frame(mae.lpmf = mae.lpmf, usergrp = 1:9), aes(x=usergrp, y=mae.lpmf))+geom_point()+ylab("MAE")+scale_x_discrete("User Groups", labels = names(grp_num)[3:11])
ggplot(data = data.frame(mae.lpmf = mae.lpmf, usergrp = 1:9), aes(x=usergrp, y=mae.lpmf))+geom_point()+ylab("MAE")+scale_x_discrete("User Groups", labels = c("1"= names(grp_num)[3], "2"= names(grp_num)[4], "3"= names(grp_num)[5], "4"= names(grp_num)[6], "5"= names(grp_num)[7], "6"= names(grp_num)[8], "7"= names(grp_num)[9], "8"= names(grp_num)[10], "9"= names(grp_num)[11]))
ggplot(data = data.frame(mae.lpmf = mae.lpmf, usergrp = as.factor(1:9)), aes(x=usergrp, y=mae.lpmf))+geom_point()+ylab("MAE")+scale_x_discrete("User Groups", labels = c("1"= names(grp_num)[3], "2"= names(grp_num)[4], "3"= names(grp_num)[5], "4"= names(grp_num)[6], "5"= names(grp_num)[7], "6"= names(grp_num)[8], "7"= names(grp_num)[9], "8"= names(grp_num)[10], "9"= names(grp_num)[11]))
ggplot(data = data.frame(mae.lpmf = mae.lpmf, usergrp = as.factor(1:9)), aes(x=usergrp, y=mae.lpmf))+geom_point()+ylab("MAE")+scale_x_discrete("User Groups", labels = c("1"= names(grp_num)[3], "2"= names(grp_num)[4], "3"= names(grp_num)[5], "4"= names(grp_num)[6], "5"= names(grp_num)[7], "6"= names(grp_num)[8], "7"= names(grp_num)[9], "8"= names(grp_num)[10], "9"= names(grp_num)[11]))+geom_line()
ggplot(data = data.frame(mae.lpmf = mae.lpmf, usergrp = as.factor(1:9)), aes(x=usergrp, y=mae.lpmf))+geom_point()+ylab("MAE")+scale_x_discrete("User Groups", labels = c("1"= names(grp_num)[3], "2"= names(grp_num)[4], "3"= names(grp_num)[5], "4"= names(grp_num)[6], "5"= names(grp_num)[7], "6"= names(grp_num)[8], "7"= names(grp_num)[9], "8"= names(grp_num)[10], "9"= names(grp_num)[11]))+geom_line()
ggplot(data = data.frame(mae.lpmf = mae.lpmf, usergrp = as.factor(1:9)), aes(x=usergrp, y=mae.lpmf))+geom_point()+geom_line()+ylab("MAE")+scale_x_discrete("User Groups", labels = c("1"= names(grp_num)[3], "2"= names(grp_num)[4], "3"= names(grp_num)[5], "4"= names(grp_num)[6], "5"= names(grp_num)[7], "6"= names(grp_num)[8], "7"= names(grp_num)[9], "8"= names(grp_num)[10], "9"= names(grp_num)[11]))
ggplot(data = data.frame(mae.lpmf = mae.lpmf, usergrp = (1:9)), aes(x=usergrp, y=mae.lpmf))+geom_point()+geom_line()+ylab("MAE")+scale_x_discrete("User Groups", labels = c("1"= names(grp_num)[3], "2"= names(grp_num)[4], "3"= names(grp_num)[5], "4"= names(grp_num)[6], "5"= names(grp_num)[7], "6"= names(grp_num)[8], "7"= names(grp_num)[9], "8"= names(grp_num)[10], "9"= names(grp_num)[11]))
ggplot(data = data.frame(mae.lpmf = mae.lpmf, usergrp = as.factor(1:9)), aes(x=usergrp, y=mae.lpmf))+geom_point()+geom_line()+ylab("MAE")+scale_x_discrete("User Groups", labels = c("1"= names(grp_num)[3], "2"= names(grp_num)[4], "3"= names(grp_num)[5], "4"= names(grp_num)[6], "5"= names(grp_num)[7], "6"= names(grp_num)[8], "7"= names(grp_num)[9], "8"= names(grp_num)[10], "9"= names(grp_num)[11]))
ggplot(data = data.frame(rmse.lpmf = rmse.lpmf, usergrp = as.factor(1:9)), aes(x=usergrp, y=rmse.lpmf))+geom_point()+geom_line()+ylab("RMSE")+scale_x_discrete("User Groups", labels = c("1"= names(grp_num)[3], "2"= names(grp_num)[4], "3"= names(grp_num)[5], "4"= names(grp_num)[6], "5"= names(grp_num)[7], "6"= names(grp_num)[8], "7"= names(grp_num)[9], "8"= names(grp_num)[10], "9"= names(grp_num)[11]))
ggsave("plot/grprmse.pdf")
ggplot(data = data.frame(mae.lpmf = mae.lpmf, usergrp = as.factor(1:9)), aes(x=usergrp, y=mae.lpmf))+geom_point()+geom_line()+ylab("MAE")+scale_x_discrete("User Groups", labels = c("1"= names(grp_num)[3], "2"= names(grp_num)[4], "3"= names(grp_num)[5], "4"= names(grp_num)[6], "5"= names(grp_num)[7], "6"= names(grp_num)[8], "7"= names(grp_num)[9], "8"= names(grp_num)[10], "9"= names(grp_num)[11]))
ggsave("plot/grpmae.pdf")
?expand.grid
aux_grp <- rep(1:9, each = grp_num[3:11])
aux_grp
table(aux_grp)
aux_grp <- NULL
for(i in 1:9){
aux_grp <- c(aux_grp, rep(i, grp_num[i+2]))
}
table(aux_grp)
aux_grp <- NULL
for(i in 1:9){
aux_grp <- c(aux_grp, rep(i, grp_num[i+2]))
}
ggplot(data = NULL, aes(x=aux_grp))+geom_bar()+scale_x_discrete("User Groups", labels = c("1"= names(grp_num)[3], "2"= names(grp_num)[4], "3"= names(grp_num)[5], "4"= names(grp_num)[6], "5"= names(grp_num)[7], "6"= names(grp_num)[8], "7"= names(grp_num)[9], "8"= names(grp_num)[10], "9"= names(grp_num)[11]))
ggsave("plot/grpnum.pdf")
aux_grp <- NULL
for(i in 1:9){
aux_grp <- c(aux_grp, rep(i, grp_num[i+2]))
}
ggplot(data = NULL, aes(x=as.factor(aux_grp)))+geom_bar()+scale_x_discrete("User Groups", labels = c("1"= names(grp_num)[3], "2"= names(grp_num)[4], "3"= names(grp_num)[5], "4"= names(grp_num)[6], "5"= names(grp_num)[7], "6"= names(grp_num)[8], "7"= names(grp_num)[9], "8"= names(grp_num)[10], "9"= names(grp_num)[11]))
ggsave("plot/grpnum.pdf")
#png("plot/warm start.png", width = 600, height = 400)
par(mfrow = c(1, 3))
plot(1:9, mae.lpmf, col = "blue", type = "l", ylab = "MAE", xaxt = "none", ylim = c(0.145, 0.185), xlab = "")
axis(1, at = 1:9, labels = names(grp_num[3:11]), las = 3)
points(1:9, mae.lpmf, col = "blue", pch = 20)
lines(1:9, mae.ws, col = "red", type = "l", ylab = "MAE")
points(1:9, mae.ws, col = "red", pch = 20)
lines(1:9, mae.avg, col = "black", type = "l", ylab = "MAE")
points(1:9, mae.avg, col = "black", pch = 20)
legend("bottomleft", legend = c("LPMF", "ws", "avg"), lty = 1, col = c("blue", "red", "black"), pch = 20)
barplot(grp_num[3:11]/sum(grp_num[3:11]), col="#69b3a2", names.arg = names(grp_num)[3:11], las = 3)
plot(1:9, rmse.lpmf, col = "blue", type = "l", ylab = "RMSE", xaxt = "none", ylim = c(0.195, 0.235), xlab = "")
axis(1, at = 1:9, labels = names(grp_num[3:11]), las = 3)
points(1:9, rmse.lpmf, col = "blue", pch = 20)
lines(1:9, rmse.ws, col = "red", type = "l", ylab = "MAE", main = "MAE: ws vs LPMF")
points(1:9, rmse.ws, col = "red", pch = 20)
lines(1:9, rmse.avg, col = "black", type = "l", ylab = "MAE")
points(1:9, rmse.avg, col = "black", pch = 20)
legend("bottomleft", legend = c("LPMF", "ws", "avg"), lty = 1, col = c("blue", "red", "black"), pch = 20)
#dev.off()
aux_grp <- NULL
for(i in 1:9){
aux_grp <- c(aux_grp, rep(i, grp_num[i+2]))
}
ggplot(data = NULL, aes(x=as.factor(aux_grp)))+geom_bar()+ylab("#Users")+scale_x_discrete("User Groups", labels = c("1"= names(grp_num)[3], "2"= names(grp_num)[4], "3"= names(grp_num)[5], "4"= names(grp_num)[6], "5"= names(grp_num)[7], "6"= names(grp_num)[8], "7"= names(grp_num)[9], "8"= names(grp_num)[10], "9"= names(grp_num)[11]))
ggsave("plot/grpnum.pdf")
aux_grp <- NULL
for(i in 1:9){
aux_grp <- c(aux_grp, rep(i, grp_num[i+2]))
}
ggplot(data = NULL, aes(x=as.factor(aux_grp)))+geom_bar()+ylab("Number of Users")+scale_x_discrete("User Groups", labels = c("1"= names(grp_num)[3], "2"= names(grp_num)[4], "3"= names(grp_num)[5], "4"= names(grp_num)[6], "5"= names(grp_num)[7], "6"= names(grp_num)[8], "7"= names(grp_num)[9], "8"= names(grp_num)[10], "9"= names(grp_num)[11]))
ggsave("plot/grpnum.pdf")
?xlab
ggplot(data = data.frame(mae = c(mae.avg, mae.lpmf, mae.ws), usergrp = as.factor(rep(1:9, 3))), aes(x=usergrp, y=mae))+geom_point()+geom_line()+ylab("MAE")+scale_x_discrete("User Groups", labels = c("1"= names(grp_num)[3], "2"= names(grp_num)[4], "3"= names(grp_num)[5], "4"= names(grp_num)[6], "5"= names(grp_num)[7], "6"= names(grp_num)[8], "7"= names(grp_num)[9], "8"= names(grp_num)[10], "9"= names(grp_num)[11]))
ggsave("plot/finmae.pdf")
ggplot(data = data.frame(mae = c(mae.avg, mae.lpmf, mae.ws), usergrp = as.factor(rep(1:9, 3)), model = rep(c("book-average", "LPMF", "WSLPMF")), each = 3), aes(x=usergrp, y=mae, color = model, shape = model))+geom_point()+geom_line()+ylab("MAE")+scale_x_discrete("User Groups", labels = c("1"= names(grp_num)[3], "2"= names(grp_num)[4], "3"= names(grp_num)[5], "4"= names(grp_num)[6], "5"= names(grp_num)[7], "6"= names(grp_num)[8], "7"= names(grp_num)[9], "8"= names(grp_num)[10], "9"= names(grp_num)[11]))
ggsave("plot/finmae.pdf")
ggplot(data = data.frame(mae = c(mae.avg, mae.lpmf, mae.ws), usergrp = as.factor(rep(1:9, 3)), model = rep(c("book-average", "LPMF", "WSLPMF")), each = 9), aes(x=usergrp, y=mae, color = model, shape = model))+geom_point()+geom_line()+ylab("MAE")+scale_x_discrete("User Groups", labels = c("1"= names(grp_num)[3], "2"= names(grp_num)[4], "3"= names(grp_num)[5], "4"= names(grp_num)[6], "5"= names(grp_num)[7], "6"= names(grp_num)[8], "7"= names(grp_num)[9], "8"= names(grp_num)[10], "9"= names(grp_num)[11]))
ggsave("plot/finmae.pdf")
ggplot(data = data.frame(mae = c(mae.avg, mae.lpmf, mae.ws), usergrp = as.factor(rep(1:9, 3)), model = rep(c("book-average", "LPMF", "WSLPMF")), each = 9), aes(x=usergrp, y=mae, color = model, shape = model))+geom_point()+ylab("MAE")+scale_x_discrete("User Groups", labels = c("1"= names(grp_num)[3], "2"= names(grp_num)[4], "3"= names(grp_num)[5], "4"= names(grp_num)[6], "5"= names(grp_num)[7], "6"= names(grp_num)[8], "7"= names(grp_num)[9], "8"= names(grp_num)[10], "9"= names(grp_num)[11]))
ggsave("plot/finmae.pdf")
ggplot(data = data.frame(mae = c(mae.avg, mae.lpmf, mae.ws), usergrp = as.factor(rep(1:9, 3)), model = rep(c("book-average", "LPMF", "WSLPMF"), each = 9)), aes(x=usergrp, y=mae, color = model, shape = model))+geom_point()+geom_line()+ylab("MAE")+scale_x_discrete("User Groups", labels = c("1"= names(grp_num)[3], "2"= names(grp_num)[4], "3"= names(grp_num)[5], "4"= names(grp_num)[6], "5"= names(grp_num)[7], "6"= names(grp_num)[8], "7"= names(grp_num)[9], "8"= names(grp_num)[10], "9"= names(grp_num)[11]))
ggsave("plot/finmae.pdf")
ggplot(data = data.frame(mae = c(mae.avg, mae.lpmf, mae.ws), usergrp = as.factor(rep(1:9, 3)), model = rep(c("book-average", "LPMF", "WSLPMF"), each = 9)), aes(x=usergrp, y=mae, color = model, shape = model))+geom_point()+geom_line(aes(x=as.numeric(usergrp), y=mae, color = model, shape = model))+ylab("MAE")+scale_x_discrete("User Groups", labels = c("1"= names(grp_num)[3], "2"= names(grp_num)[4], "3"= names(grp_num)[5], "4"= names(grp_num)[6], "5"= names(grp_num)[7], "6"= names(grp_num)[8], "7"= names(grp_num)[9], "8"= names(grp_num)[10], "9"= names(grp_num)[11]))
ggsave("plot/finmae.pdf")
ggplot(data = data.frame(mae.lpmf = mae.lpmf, usergrp = as.factor(1:9)), aes(x=usergrp, y=mae.lpmf))+geom_point()+geom_line(aes(x=usergrp, y=as.numeric(mae.lpmf)))+ylab("MAE")+scale_x_discrete("User Groups", labels = c("1"= names(grp_num)[3], "2"= names(grp_num)[4], "3"= names(grp_num)[5], "4"= names(grp_num)[6], "5"= names(grp_num)[7], "6"= names(grp_num)[8], "7"= names(grp_num)[9], "8"= names(grp_num)[10], "9"= names(grp_num)[11]))
ggsave("plot/grpmae.pdf")
ggplot(data = data.frame(mae.lpmf = mae.lpmf, usergrp = as.factor(1:9)), aes(x=usergrp, y=mae.lpmf))+geom_point()+geom_line(aes(x=as.numeric(usergrp), y=as.numeric(mae.lpmf)))+ylab("MAE")+scale_x_discrete("User Groups", labels = c("1"= names(grp_num)[3], "2"= names(grp_num)[4], "3"= names(grp_num)[5], "4"= names(grp_num)[6], "5"= names(grp_num)[7], "6"= names(grp_num)[8], "7"= names(grp_num)[9], "8"= names(grp_num)[10], "9"= names(grp_num)[11]))
ggsave("plot/grpmae.pdf")
ggplot(data = data.frame(rmse.lpmf = rmse.lpmf, usergrp = as.factor(1:9)), aes(x=usergrp, y=rmse.lpmf))+geom_point()+geom_line(aes(x=as.numeric(usergrp), y=as.numeric(rmse.lpmf)))+ylab("RMSE")+scale_x_discrete("User Groups", labels = c("1"= names(grp_num)[3], "2"= names(grp_num)[4], "3"= names(grp_num)[5], "4"= names(grp_num)[6], "5"= names(grp_num)[7], "6"= names(grp_num)[8], "7"= names(grp_num)[9], "8"= names(grp_num)[10], "9"= names(grp_num)[11]))
ggsave("plot/grprmse.pdf")
ggplot(data = data.frame(rmse = c(rmse.avg, rmse.lpmf, rmse.ws), usergrp = as.factor(rep(1:9, 3)), model = rep(c("book-average", "LPMF", "WSLPMF"), each = 9)), aes(x=usergrp, y=rmse, color = model, shape = model))+geom_point()+geom_line(aes(x=as.numeric(usergrp), y=rmse, color = model, shape = model))+ylab("RMSE")+scale_x_discrete("User Groups", labels = c("1"= names(grp_num)[3], "2"= names(grp_num)[4], "3"= names(grp_num)[5], "4"= names(grp_num)[6], "5"= names(grp_num)[7], "6"= names(grp_num)[8], "7"= names(grp_num)[9], "8"= names(grp_num)[10], "9"= names(grp_num)[11]))
ggsave("plot/finrmse.pdf")
user.Rating <- merge(user.Rating, Users)
Rating_by_age <- group_by(user.Rating, Age) %>% summarise(
user.num = length(num),
avg.rating = sum(num*avg.rating)/sum(num)
)
View(user.Rating)
ggplot(data = data.frame(mae.lpmf = mae.lpmf, usergrp = as.factor(1:9)), aes(x=usergrp, y=mae.lpmf))+geom_bar()+ylab("MAE")+scale_x_discrete("User Groups", labels = c("1"= names(grp_num)[3], "2"= names(grp_num)[4], "3"= names(grp_num)[5], "4"= names(grp_num)[6], "5"= names(grp_num)[7], "6"= names(grp_num)[8], "7"= names(grp_num)[9], "8"= names(grp_num)[10], "9"= names(grp_num)[11]))
ggplot(data = data.frame(mae.lpmf = mae.lpmf, usergrp = as.factor(1:9)), aes(x=usergrp, y=mae.lpmf))+geom_bar(stat="identity")+ylab("MAE")+scale_x_discrete("User Groups", labels = c("1"= names(grp_num)[3], "2"= names(grp_num)[4], "3"= names(grp_num)[5], "4"= names(grp_num)[6], "5"= names(grp_num)[7], "6"= names(grp_num)[8], "7"= names(grp_num)[9], "8"= names(grp_num)[10], "9"= names(grp_num)[11]))
ggsave("plot/grpmaebar.pdf")
ggplot(data = data.frame(rmse.lpmf = rmse.lpmf, usergrp = as.factor(1:9)), aes(x=usergrp, y=rmse.lpmf))+geom_bar(stat="identity")+ylab("RMSE")+scale_x_discrete("User Groups", labels = c("1"= names(grp_num)[3], "2"= names(grp_num)[4], "3"= names(grp_num)[5], "4"= names(grp_num)[6], "5"= names(grp_num)[7], "6"= names(grp_num)[8], "7"= names(grp_num)[9], "8"= names(grp_num)[10], "9"= names(grp_num)[11]))
ggsave("plot/grprmsebar.pdf")
user.Rating <- merge(user.Rating, Users)
Rating_by_age <- group_by(user.Rating, Age) %>% summarise(
user.num = length(num),
avg.rating = sum(num*avg.rating)/sum(num),
sd.ratign = sd(avg.rating)
)
View(Rating_by_age)
user.Rating <- merge(user.Rating, Users)
Rating_by_age <- group_by(user.Rating, Age) %>% summarise(
user.num = length(num),
avg = sum(num*avg.rating)/sum(num),
sd = sd(avg.rating)
)
Users <- read.csv("archive/Users.csv")
Users <- Users[1:N, ]
Users[is.na(Users$Age), "Age"] <- 0
Users[which(Users$Age > 100), "Age"] <- 0
Users[which(Users$Age < 7), "Age"] <- 0
user.Rating <- merge(user.Rating, Users)
Rating_by_age <- group_by(user.Rating, Age) %>% summarise(
user.num = length(num),
avg = sum(num*avg.rating)/sum(num),
sd = sd(avg.rating)
)
View(Rating_by_age)
View(Users)
age <- NULL
for(i in 1:nrow(train)){
age[i] <- Users[which(Users$User.ID == train[i, ]$User.ID), "Age"]
}
train$age <- age
View(train)
View(Books)
year <- NULL
for(i in 1:nrow(train)){
if(names(book_idx)[train[i, "ISBN"]] %in% Books$ISBN ){
year[i] <- Books[which(Books$ISBN==train[i, "ISBN"]), "Year.Of.Publication"]
}else{
year[i] <- 0
}
}
year <- NULL
for(i in 1:nrow(train)){
if(names(book_idx)[train[i, "ISBN"]] %in% Books$ISBN ){
year[i] <- Books[which(Books$ISBN==names(book_idx)[train[i, "ISBN"]]), "Year.Of.Publication"]
}else{
year[i] <- 0
}
}
View(train)
year <- NULL
for(i in 1:nrow(train)){
if(names(book_idx)[train[i, "ISBN"]] %in% Books$ISBN ){
browser()
year[i] <- Books[which(Books$ISBN==names(book_idx)[train[i, "ISBN"]]), "Year.Of.Publication"]
}else{
year[i] <- 0
}
}
train[i, "ISBN"]
i
i
i
i
i
i
10%%3
year <- NULL
for(i in 1:nrow(train)){
if(i %% 1e3 == 0){
browser()
}
if(names(book_idx)[train[i, "ISBN"]] %in% Books$ISBN ){
year[i] <- Books[which(Books$ISBN==names(book_idx)[train[i, "ISBN"]]), "Year.Of.Publication"]
}else{
year[i] <- 0
}
}
train$year <- year
Ratings_by_year <- group_by(train, year) %>% summarise(
avg = mean(Book.Rating),
sd = sd(Book.Rating)
)
train$age <- as.factor(age)
summary(train)
summary(train)
age
train$age <- unlist(age)
summary(train)
train$age <- as.factor(unlist(age))
train$year <- as.factor(year)
summary(anova(Book.Rating~age, data=train))
summary(aov(Book.Rating~age, data=train))
summary(aov(Book.Rating~year, data=train))
summary(aov(Book.Rating~age, data=train[which(train$age!=0), ]))
summary(aov(Book.Rating~year, data=train[which(train$year!=0), ]))
install.packages("ggpubr")
library(dplyr)
library(Rcpp)
library(ggplot2)
library(showtext)
library(ggrepel)
showtext_auto()
library("ggpubr")
ggline(train, x = "age", y = "Book.Rating",
add = c("mean_se", "jitter"),
order = c("ctrl", "trt1", "trt2"),
ylab = "Rating", xlab = "Age")
ggline(train, x = "age", y = "Book.Rating",
add = c("mean_se", "jitter"),
ylab = "Rating", xlab = "Age")
seq(10, 50, 10)
ggline(train[which(train$age %in% seq(10, 50, 10)), ], x = "age", y = "Book.Rating",
add = c("mean_se", "jitter"),
ylab = "Rating", xlab = "Age")
ggboxplot(train[which(train$age %in% seq(10, 50, 10)), ], x = "age", y = "Book.Rating",
add = c("mean_se", "jitter"),
ylab = "Rating", xlab = "Age")
ggboxplot(train[which(train$age %in% seq(10, 50, 10)), ], x = "age", y = "Book.Rating",
add = c("mean_se"),
ylab = "Rating", xlab = "Age")
ggline(train[which(train$age %in% seq(10, 50, 10)), ], x = "age", y = "Book.Rating",
add = c("mean_se"),
ylab = "Rating", xlab = "Age")
sum(train$age == 10)
sum(train$age == 20)
sum(train$age == 30)
sum(train$age == 40)
sum(train$age == 50)
ggline(train[which(train$age %in% seq(10, 50, 10)), ], x = "age", y = "Book.Rating",
add = c("mean_se"),
ylab = "Rating", xlab = "Age")+scale_x_discrete("Age", labels = c("10"="10(99)", "20" = "20(2778)", "30"="30(7631)", "40"="40(4767)", "50"="50(2996)"))
ggline(train[which(train$age %in% seq(10, 50, 10)), ], x = "age", y = "Book.Rating",
add = c("mean_se"),
ylab = "Rating", xlab = "Age")+scale_x_discrete("Age", labels = c("10"="10(99)", "20" = "20(2778)", "30"="30(7631)", "40"="40(4767)", "50"="50(2996)"))
ggsave("plot/age.pdf")
View(Ratings_by_year)
View(Ratings_by_users)
View(Ratings_by_users)
View(Rating_by_age)
View(train)
summary(train)
Ratings_by_year <- group_by(train, year) %>% summarise(
avg = mean(Book.Rating)*9,
sd = sd(Book.Rating)*9
)
sum(train$year == 2000)
sum(train$year == 2001)
sum(train$year == 2002)
sum(train$year == 2003)
sum(train$year == 2004)
ggline(train[which(train$year %in% seq(2000, 2004, 1)), ], x = "year", y = "Book.Rating",
add = c("mean_se"),
ylab = "Rating", xlab = "Year")+scale_x_discrete("Year", labels = c("2000"="(22112)", "2001" = "(25093)", "2002"="(29640)", "2003"="(22454)", "2004"="(7611)"))
ggsave("plot/year.pdf")
ggline(train[which(train$year %in% seq(2000, 2004, 1)), ], x = "year", y = "Book.Rating",
add = c("mean_se"),
ylab = "Rating", xlab = "Year")+scale_x_discrete("Year", labels = c("2000"="2000(22112)", "2001" = "2001(25093)", "2002"="2002(29640)", "2003"="2003(22454)", "2004"="2004(7611)"))
ggsave("plot/year.pdf")
ggline(train[which(train$year %in% seq(2000, 2004, 1)), ], x = "year", y = "Book.Rating",
add = c("mean_se"),
ylab = "Rating", xlab = "Year")+scale_x_discrete("Year", labels = c("2000"="2000", "2001" = "2001", "2002"="2002", "2003"="2003", "2004"="2004"))
ggsave("plot/year.pdf")
